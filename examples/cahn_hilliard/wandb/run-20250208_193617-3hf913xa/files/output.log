Training time window 1
Waiting for JIT...
Device: gpu
Step: 0
Step done
[19:37:13 - main - INFO] ---------------------------
[19:37:13 - main - INFO] Iter:   0    Time: 52.377
[19:37:13 - main - INFO] -----------  --------------
[19:37:13 - main - INFO] bc_loss      5.151e-03
[19:37:13 - main - INFO] ics_loss     3.589e+01
[19:37:13 - main - INFO] res_loss     1.555e-01
[19:37:13 - main - INFO] l2_error     7.563e+00
Step: 1
Step done
Step: 2
Step done
Step: 3
Step done
Step: 4
Step done
Step: 5
Step done
Step: 6
Step done
Step: 7
Step done
Step: 8
Step done
Step: 9
Step done
Step: 10
Step done
Step: 11
Step done
Step: 12
Step done
Step: 13
Step done
Step: 14
Step done
Step: 15
Step done
Step: 16
Step done
Step: 17
Step done
Step: 18
Step done
Step: 19
Step done
Step: 20
Step done
Step: 21
Step done
Step: 22
Step done
Step: 23
Step done
Step: 24
Step done
Step: 25
Step done
Step: 26
Step done
Step: 27
Step done
Step: 28
Step done
Step: 29
Step done
Step: 30
Step done
Step: 31
Step done
Step: 32
Step done
Step: 33
Step done
Step: 34
Step done
Step: 35
Step done
Step: 36
Step done
Step: 37
Step done
Step: 38
Step done
Step: 39
Step done
Step: 40
Step done
Step: 41
Step done
Step: 42
Step done
Step: 43
Step done
Step: 44
Step done
Step: 45
Step done
Step: 46
Step done
Step: 47
Step done
Step: 48
Step done
Step: 49
Step done
Step: 50
Step done
Step: 51
Step done
Step: 52
Step done
Step: 53
Step done
Step: 54
Step done
Step: 55
Step done
Step: 56
Step done
Step: 57
Step done
Step: 58
Step done
Step: 59
Step done
Step: 60
Step done
Step: 61
Step done
Step: 62
Step done
Step: 63
Step done
Step: 64
Step done
Step: 65
Step done
Step: 66
Step done
Step: 67
Step done
Step: 68
Step done
Step: 69
Step done
Step: 70
Step done
Step: 71
Step done
Step: 72
Step done
Step: 73
Step done
Step: 74
Step done
Step: 75
Step done
Step: 76
Step done
Step: 77
Step done
Step: 78
Step done
Step: 79
Step done
Step: 80
Step done
Step: 81
Step done
Step: 82
Step done
Step: 83
Step done
Step: 84
Step done
Step: 85
Step done
Step: 86
Step done
Step: 87
Step done
Step: 88
Step done
Step: 89
Step done
Step: 90
Step done
Step: 91
Step done
Step: 92
Step done
Step: 93
Step done
Step: 94
Step done
Step: 95
Step done
Step: 96
Step done
Step: 97
Step done
Step: 98
Step done
Step: 99
Step done
Step: 100
Step done
[19:37:29 - main - INFO] ---------------------------
[19:37:29 - main - INFO] Iter: 100    Time: 16.715
[19:37:29 - main - INFO] -----------  --------------
[19:37:29 - main - INFO] bc_loss      1.417e-06
[19:37:29 - main - INFO] ics_loss     4.122e-01
[19:37:29 - main - INFO] res_loss     1.493e-05
[19:37:29 - main - INFO] l2_error     1.006e+00
Step: 101
Step done
Step: 102
Step done
Step: 103
Step done
Step: 104
Step done
Step: 105
Step done
Step: 106
Step done
Step: 107
Step done
Step: 108
Step done
Step: 109
Step done
Step: 110
Step done
Step: 111
Step done
Step: 112
Step done
Step: 113
Step done
Step: 114
Step done
Step: 115
Step done
Step: 116
Step done
Step: 117
Step done
Step: 118
Step done
Step: 119
Step done
Step: 120
Step done
Step: 121
Step done
Step: 122
Step done
Step: 123
Step done
Step: 124
Step done
Step: 125
Step done
Step: 126
Step done
Step: 127
Step done
Step: 128
Step done
Step: 129
Step done
Step: 130
Step done
Step: 131
Step done
Step: 132
Step done
Step: 133
Step done
Step: 134
Step done
Step: 135
Step done
Step: 136
Step done
Step: 137
Step done
Step: 138
Step done
Step: 139
Step done
Step: 140
Step done
Step: 141
Step done
Step: 142
Step done
Step: 143
Step done
Step: 144
Step done
Step: 145
Step done
Step: 146
Step done
Step: 147
Step done
Step: 148
Step done
Step: 149
Step done
Step: 150
Step done
Step: 151
Step done
Step: 152
Step done
Step: 153
Step done
Step: 154
Step done
Step: 155
Step done
Step: 156
Step done
Step: 157
Step done
Step: 158
Step done
Step: 159
Step done
Step: 160
Step done
Step: 161
Step done
Step: 162
Step done
Step: 163
Step done
Step: 164
Step done
Step: 165
Step done
Step: 166
Step done
Step: 167
Step done
Step: 168
Step done
Step: 169
Step done
Step: 170
Step done
Step: 171
Step done
Step: 172
Step done
Step: 173
Step done
Step: 174
Step done
Step: 175
Step done
Step: 176
Step done
Step: 177
Step done
Step: 178
Step done
Step: 179
Step done
Step: 180
Step done
Step: 181
Step done
Step: 182
Step done
Step: 183
Step done
Step: 184
Step done
Step: 185
Step done
Step: 186
Step done
Step: 187
Step done
Step: 188
Step done
Step: 189
Step done
Step: 190
Step done
Step: 191
Step done
Step: 192
Step done
Step: 193
Step done
Step: 194
Step done
Step: 195
Step done
Step: 196
Step done
Step: 197
Step done
Step: 198
Step done
Step: 199
Step done
Step: 200
Step done
[19:37:31 - main - INFO] --------------------------
[19:37:31 - main - INFO] Iter: 200    Time: 1.625
[19:37:31 - main - INFO] -----------  -------------
[19:37:31 - main - INFO] bc_loss      1.525e-06
[19:37:31 - main - INFO] ics_loss     4.119e-01
[19:37:31 - main - INFO] res_loss     1.053e-05
[19:37:31 - main - INFO] l2_error     1.008e+00
Step: 201
Step done
Step: 202
Step done
Step: 203
Step done
Step: 204
Step done
Step: 205
Step done
Step: 206
Step done
Step: 207
Step done
Step: 208
Step done
Step: 209
Step done
Step: 210
Step done
Step: 211
Step done
Step: 212
Step done
Step: 213
Step done
Step: 214
Step done
Step: 215
Step done
Step: 216
Step done
Step: 217
Step done
Step: 218
Step done
Step: 219
Step done
Step: 220
Step done
Step: 221
Step done
Step: 222
Step done
Step: 223
Step done
Step: 224
Step done
Step: 225
Step done
Step: 226
Step done
Step: 227
Step done
Step: 228
Step done
Step: 229
Step done
Step: 230
Step done
Step: 231
Step done
Step: 232
Step done
Step: 233
Step done
Step: 234
Step done
Step: 235
Step done
Step: 236
Step done
Step: 237
Step done
Step: 238
Step done
Step: 239
Step done
Step: 240
Step done
Step: 241
Step done
Step: 242
Step done
Step: 243
Step done
Step: 244
Step done
Step: 245
Step done
Step: 246
Step done
Step: 247
Step done
Step: 248
Step done
Step: 249
Step done
Step: 250
Step done
Step: 251
Step done
Step: 252
Step done
Step: 253
Step done
Step: 254
Step done
Step: 255
Step done
Step: 256
Step done
Step: 257
Step done
Step: 258
Step done
Step: 259
Step done
Step: 260
Step done
Step: 261
Step done
Step: 262
Step done
Step: 263
Step done
Step: 264
Step done
Step: 265
Step done
Step: 266
Step done
Step: 267
Step done
Step: 268
Step done
Step: 269
Step done
Step: 270
Step done
Step: 271
Step done
Step: 272
Step done
Step: 273
Step done
Step: 274
Step done
Step: 275
Step done
Step: 276
Step done
Step: 277
Step done
Step: 278
Step done
Step: 279
Step done
Step: 280
Step done
Step: 281
Step done
Step: 282
Step done
Step: 283
Step done
Step: 284
Step done
Step: 285
Step done
Step: 286
Step done
Step: 287
Step done
Step: 288
Step done
Step: 289
Step done
Step: 290
Step done
Step: 291
Step done
Step: 292
Step done
Step: 293
Step done
Step: 294
Step done
Step: 295
Step done
Step: 296
Step done
Step: 297
Step done
Step: 298
Step done
Step: 299
Step done
Step: 300
Step done
[19:37:33 - main - INFO] --------------------------
[19:37:33 - main - INFO] Iter: 300    Time: 1.634
[19:37:33 - main - INFO] -----------  -------------
[19:37:33 - main - INFO] bc_loss      1.710e-06
[19:37:33 - main - INFO] ics_loss     4.118e-01
[19:37:33 - main - INFO] res_loss     1.120e-05
[19:37:33 - main - INFO] l2_error     1.010e+00
Step: 301
Step done
Step: 302
Step done
Step: 303
Step done
Step: 304
Step done
Step: 305
Step done
Step: 306
Step done
Step: 307
Step done
Step: 308
Step done
Step: 309
Step done
Step: 310
Step done
Step: 311
Step done
Step: 312
Step done
Step: 313
Step done
Step: 314
Step done
Step: 315
Step done
Step: 316
Step done
Step: 317
Step done
Step: 318
Step done
Step: 319
Step done
Step: 320
Step done
Step: 321
Step done
Step: 322
Step done
Step: 323
Step done
Step: 324
Step done
Step: 325
Step done
Step: 326
Step done
Step: 327
Step done
Step: 328
Step done
Step: 329
Step done
Step: 330
Step done
Step: 331
Step done
Step: 332
Step done
Step: 333
Step done
Step: 334
Step done
Step: 335
Step done
Step: 336
Step done
Step: 337
Step done
Step: 338
Step done
Step: 339
Step done
Step: 340
Step done
Step: 341
Step done
Step: 342
Step done
Step: 343
Step done
Step: 344
Step done
Step: 345
Step done
Step: 346
Step done
Step: 347
Step done
Step: 348
Step done
Step: 349
Step done
Step: 350
Step done
Step: 351
Step done
Step: 352
Step done
Step: 353
Step done
Step: 354
Step done
Step: 355
Step done
Step: 356
Step done
Step: 357
Step done
Step: 358
Step done
Step: 359
Step done
Step: 360
Step done
Step: 361
Step done
Step: 362
Step done
Step: 363
Step done
Step: 364
Step done
Step: 365
Step done
Step: 366
Step done
Step: 367
Step done
Step: 368
Step done
Step: 369
Step done
Step: 370
Step done
Step: 371
Step done
Step: 372
Step done
Step: 373
Step done
Step: 374
Step done
Step: 375
Step done
Step: 376
Step done
Step: 377
Step done
Step: 378
Step done
Step: 379
Step done
Step: 380
Step done
Step: 381
Step done
Step: 382
Step done
Step: 383
Step done
Step: 384
Step done
Step: 385
Step done
Step: 386
Step done
Step: 387
Step done
Step: 388
Step done
Step: 389
Step done
Step: 390
Step done
Step: 391
Step done
Step: 392
Step done
Step: 393
Step done
Step: 394
Step done
Step: 395
Step done
Step: 396
Step done
Step: 397
Step done
Step: 398
Step done
Step: 399
Step done
Step: 400
Step done
Traceback (most recent call last):
  File "/home/david/work/repos/deep-learning-pde/jaxpi/examples/cahn_hilliard/main.py", line 43, in <module>
    app.run(main)
    ~~~~~~~^^^^^^
  File "/home/david/anaconda3/envs/jaxpi/lib/python3.13/site-packages/absl/app.py", line 308, in run
    _run_main(main, args)
    ~~~~~~~~~^^^^^^^^^^^^
  File "/home/david/anaconda3/envs/jaxpi/lib/python3.13/site-packages/absl/app.py", line 254, in _run_main
    sys.exit(main(argv))
             ~~~~^^^^^^
  File "/home/david/work/repos/deep-learning-pde/jaxpi/examples/cahn_hilliard/main.py", line 35, in main
    train.train_and_evaluate(FLAGS.config, FLAGS.workdir)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/david/work/repos/deep-learning-pde/jaxpi/examples/cahn_hilliard/train.py", line 112, in train_and_evaluate
    model = train_one_window(config, workdir, model, samplers, u, idx)
  File "/home/david/work/repos/deep-learning-pde/jaxpi/examples/cahn_hilliard/train.py", line 53, in train_one_window
    batch = jax.device_get(tree_map(lambda x: x[0], batch))
                           ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/david/anaconda3/envs/jaxpi/lib/python3.13/site-packages/jax/_src/tree_util.py", line 358, in tree_map
    return treedef.unflatten(f(*xs) for xs in zip(*all_leaves))
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/david/anaconda3/envs/jaxpi/lib/python3.13/site-packages/jax/_src/tree_util.py", line 358, in <genexpr>
    return treedef.unflatten(f(*xs) for xs in zip(*all_leaves))
                             ~^^^^^
  File "/home/david/work/repos/deep-learning-pde/jaxpi/examples/cahn_hilliard/train.py", line 53, in <lambda>
    batch = jax.device_get(tree_map(lambda x: x[0], batch))
                                              ~^^^
  File "/home/david/anaconda3/envs/jaxpi/lib/python3.13/site-packages/jax/_src/array.py", line 364, in __getitem__
    out = lax.squeeze(out, dimensions=dims)
  File "/home/david/anaconda3/envs/jaxpi/lib/python3.13/site-packages/jax/_src/lax/lax.py", line 2089, in squeeze
    return squeeze_p.bind(array, dimensions=dimensions)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/david/anaconda3/envs/jaxpi/lib/python3.13/site-packages/jax/_src/core.py", line 463, in bind
    return self.bind_with_trace(prev_trace, args, params)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/david/anaconda3/envs/jaxpi/lib/python3.13/site-packages/jax/_src/core.py", line 468, in bind_with_trace
    return trace.process_primitive(self, args, params)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/home/david/anaconda3/envs/jaxpi/lib/python3.13/site-packages/jax/_src/core.py", line 954, in process_primitive
    return primitive.impl(*args, **params)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/david/anaconda3/envs/jaxpi/lib/python3.13/site-packages/jax/_src/dispatch.py", line 89, in apply_primitive
    outs = fun(*args)
KeyboardInterrupt
