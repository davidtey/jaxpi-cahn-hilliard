Training time window 1
Waiting for JIT...
I0201 14:21:00.472259 140400264914752 utils.py:148] Note: NumExpr detected 16 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
I0201 14:21:00.472507 140400264914752 utils.py:160] NumExpr defaulting to 8 threads.
[14:21:00 - main - INFO] ---------------------------
[14:21:00 - main - INFO] Iter:   0    Time: 25.212
[14:21:00 - main - INFO] -----------  --------------
[14:21:00 - main - INFO] ics_loss     1.004e+00
[14:21:00 - main - INFO] res_loss     2.181e+03
[14:21:00 - main - INFO] l2_error     1.205e+00
[14:22:16 - main - INFO] ---------------------------
[14:22:16 - main - INFO] Iter: 100    Time: 75.523
[14:22:16 - main - INFO] -----------  --------------
[14:22:16 - main - INFO] ics_loss     2.099e-05
[14:22:16 - main - INFO] res_loss     4.896e-02
[14:22:16 - main - INFO] l2_error     2.963e-01
Traceback (most recent call last):
  File "/home/david/work/repos/deep-learning-pde/jaxpi/examples/ks/main.py", line 41, in <module>
    app.run(main)
  File "/home/david/anaconda3/lib/python3.12/site-packages/absl/app.py", line 308, in run
    _run_main(main, args)
  File "/home/david/anaconda3/lib/python3.12/site-packages/absl/app.py", line 254, in _run_main
    sys.exit(main(argv))
             ^^^^^^^^^^
  File "/home/david/work/repos/deep-learning-pde/jaxpi/examples/ks/main.py", line 33, in main
    train.train_and_evaluate(FLAGS.config, FLAGS.workdir)
  File "/home/david/work/repos/deep-learning-pde/jaxpi/examples/ks/train.py", line 96, in train_and_evaluate
    model = train_one_window(config, workdir, model, res_sampler, u, idx)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/david/work/repos/deep-learning-pde/jaxpi/examples/ks/train.py", line 31, in train_one_window
    batch = next(res_sampler)
            ^^^^^^^^^^^^^^^^^
  File "/home/david/anaconda3/lib/python3.12/site-packages/jaxpi/samplers.py", line 20, in __getitem__
    batch = self.data_generation(keys)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/david/anaconda3/lib/python3.12/site-packages/jax/_src/api.py", line 1607, in <lambda>
    lambda x, s: pxla.shard_args([s], [None], [None], [x])[0],

KeyboardInterrupt
